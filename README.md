# Скрипт проверки наличия текста на веб-страницах

## Описание

Этот скрипт предназначен для автоматической проверки наличия текстовых строк из столбца G Excel файла на веб-страницах по ссылкам из столбца I.

## Возможности

- ✅ Чтение данных из Excel файла
- ✅ Выполнение HTTP запросов к веб-страницам
- ✅ Парсинг HTML контента
- ✅ Поиск текста на странице
- ✅ Детальное логирование результатов
- ✅ Обработка ошибок (таймауты, недоступные страницы и т.д.)
- ✅ Задержки между запросами для предотвращения блокировки
- ✅ Статистика по завершению обработки

## Установка

### 1. Установите Python

Убедитесь, что у вас установлен Python 3.8 или выше.

### 2. Установите зависимости

```bash
pip install -r requirements.txt
```

Или установите вручную:

```bash
pip install pandas openpyxl requests beautifulsoup4 lxml
```

## Использование

### Запуск скрипта

```bash
python check_links.py
```

### Формат входных данных

Скрипт ожидает Excel файл с именем:
```
Antisemitizm_v_Runete_29_09_2025_12_10_2025_68ee12385c4b17276166d275.xlsx
```

Структура файла:
- **Столбец G**: Текстовые строки для поиска
- **Столбец I**: Ссылки на веб-страницы

### Выходные данные

Скрипт создает лог-файл с именем формата:
```
check_results_YYYYMMDD_HHMMSS.log
```

В логе для каждой строки указывается:
- Номер строки
- Текст для поиска
- Ссылка
- Результат проверки (найдено/не найдено/ошибка)

## Примеры вывода

### Успешное нахождение текста
```
2025-11-12 10:15:23 - INFO - Строка 5: ✓ НАЙДЕНО - Текст присутствует на странице
```

### Текст не найден
```
2025-11-12 10:15:25 - WARNING - Строка 7: ✗ НЕ НАЙДЕНО - Текст отсутствует на странице
```

### Ошибка при обработке
```
2025-11-12 10:15:27 - ERROR - Строка 10: ОШИБКА - Таймаут при обращении к https://example.com
```

### Итоговая статистика
```
================================================================================
ИТОГОВАЯ СТАТИСТИКА:
Всего обработано строк: 100
Текст найден: 75
Текст не найден: 20
Ошибки при обработке: 5
================================================================================
```

## Настройки

В скрипте можно изменить следующие параметры:

- **delay** (по умолчанию 1 секунда): Задержка между запросами
- **timeout** (по умолчанию 10 секунд): Таймаут для HTTP запросов
- **HEADERS**: Заголовки HTTP запросов

## Обработка ошибок

Скрипт обрабатывает следующие типы ошибок:
- Таймауты соединения
- Ошибки HTTP (404, 403, 500 и т.д.)
- Недоступные серверы
- Невалидные URL
- Пустые значения в столбцах

## Рекомендации

1. **Задержка между запросами**: Не уменьшайте значение delay ниже 1 секунды, чтобы избежать блокировки
2. **Большие файлы**: Для файлов с большим количеством строк рекомендуется запускать скрипт в фоновом режиме
3. **Проксирование**: Для большого количества запросов рекомендуется использовать прокси-серверы

## Лицензия

MIT

## Автор

Created with AI assistance

